{"version":3,"sources":["http/request/request.js"],"names":["getOneDate","req","parameter","dateString","query","errors","date","error","httpErrors","InvalidParameterError","expectedType","value","getListFromReq","getListApiIdFromReq","expectedTypes","listId","createError","apiId","InvalidResourceTypeError","InvalidApiIdError","reduce","push"],"mappings":";;;;;;;;;AAEA;;AAIA;;AACA;;;;AAPA;AACA;AAQA;AACA;;AAEA;;;;;;;AAOA,SAASA,UAAT,CAAoBC,GAApB,EAAyBC,SAAzB,EAAoC;AAChC,QAAMC,UAAU,GAAGF,GAAG,CAACG,KAAJ,CAAUF,SAAV,CAAnB;;AAEA,MAAI,CAACC,UAAL,EAAiB;AACb,WAAO;AAAEE,MAAAA,MAAM,EAAE;AAAV,KAAP;AACH;;AAED,QAAMC,IAAI,GAAG,+BAAiBH,UAAjB,CAAb;;AAEA,MAAI,CAACG,IAAL,EAAW;AACP;AACA,UAAMC,KAAK,GAAG,IAAIC,UAAU,CAACC,qBAAf,CAAqC;AAC/CP,MAAAA,SAD+C;AAE/CQ,MAAAA,YAAY,EAAE,MAFiC;AAG/CC,MAAAA,KAAK,EAAER;AAHwC,KAArC,CAAd;AAMA,WAAO;AAAEE,MAAAA,MAAM,EAAE,CAACE,KAAD;AAAV,KAAP;AACH;;AAED,SAAO;AAAEI,IAAAA,KAAK,EAAEL,IAAT;AAAeD,IAAAA,MAAM,EAAE;AAAvB,GAAP;AACH;AAED;;;;;;;;AAMA,SAASO,cAAT,CAAwBX,GAAxB,EAA6BC,SAA7B,EAAwC;AACpC,SAAO,OAAOD,GAAG,CAACG,KAAJ,CAAUF,SAAV,CAAP,KAAgC,QAAhC,GACD,CAACD,GAAG,CAACG,KAAJ,CAAUF,SAAV,CAAD,CADC,GAEDD,GAAG,CAACG,KAAJ,CAAUF,SAAV,KAAwB,EAF9B;AAGH;AAED;;;;;;;;;AAOA,SAASW,mBAAT,CAA6BZ,GAA7B,EAAkCC,SAAlC,EAA6CY,aAA7C,EAA4D;AACxD,QAAMC,MAAM,GAAGH,cAAc,CAACX,GAAD,EAAMC,SAAN,CAA7B;AAEA,QAAMc,WAAW,GAAGF,aAAa,GAC3BG,KAAK,IAAI,IAAIT,UAAU,CAACU,wBAAf,CAAwC;AAC/ChB,IAAAA,SAD+C;AAE/CY,IAAAA,aAF+C;AAG/CG,IAAAA;AAH+C,GAAxC,CADkB,GAM3BA,KAAK,IAAI,IAAIT,UAAU,CAACW,iBAAf,CAAiC;AACxCjB,IAAAA,SADwC;AAExCe,IAAAA;AAFwC,GAAjC,CANf,CAHwD,CAcxD;;AACA,SAAOF,MAAM,CAACK,MAAP,CAAc,CAAC;AAAET,IAAAA,KAAF;AAASN,IAAAA;AAAT,GAAD,EAAoBY,KAApB,KAA8B;AAC/C,QAAI,uBAAaA,KAAb,EAAoBH,aAApB,CAAJ,EAAwC;AACpCH,MAAAA,KAAK,CAACU,IAAN,CAAWJ,KAAX;AACH,KAFD,MAGK;AACDZ,MAAAA,MAAM,CAACgB,IAAP,CAAYL,WAAW,CAACC,KAAD,CAAvB;AACH;;AAED,WAAO;AAAEN,MAAAA,KAAF;AAASN,MAAAA;AAAT,KAAP;AACH,GATM,EASJ;AAAEM,IAAAA,KAAK,EAAE,EAAT;AAAaN,IAAAA,MAAM,EAAE;AAArB,GATI,CAAP;AAUH,C,CAED;AACA","sourcesContent":["// ============================================================\n// Import modules\nimport {\n    isValidApiId,\n} from '../../api';\n\nimport * as httpErrors from './errors';\nimport { toDateFromString } from '../../helpers';\n\n// ============================================================\n// Functions\n\n/**\n *\n * @param {Request} req\n * @param {string}  parameter\n * @returns {{value: Date?, errors: RequestError[]}}\n * @public\n */\nfunction getOneDate(req, parameter) {\n    const dateString = req.query[parameter];\n\n    if (!dateString) {\n        return { errors: [] };\n    }\n\n    const date = toDateFromString(dateString);\n\n    if (!date) {\n        /** @type {RequestError} */\n        const error = new httpErrors.InvalidParameterError({\n            parameter,\n            expectedType: 'Date',\n            value: dateString,\n        });\n\n        return { errors: [error] };\n    }\n\n    return { value: date, errors: [] };\n}\n\n/**\n *\n * @param {Request} req\n * @param {string}  parameter\n * @returns {string[]}\n */\nfunction getListFromReq(req, parameter) {\n    return typeof req.query[parameter] === 'string'\n        ? [req.query[parameter]]\n        : req.query[parameter] || [];\n}\n\n/**\n *\n * @param {Request}                     req\n * @param {string}                      parameter\n * @param {ResourceType|ResourceType[]} expectedTypes\n * @returns {{list: ApiId[], errors: RequestError[]}}\n */\nfunction getListApiIdFromReq(req, parameter, expectedTypes) {\n    const listId = getListFromReq(req, parameter);\n\n    const createError = expectedTypes\n        ? apiId => new httpErrors.InvalidResourceTypeError({\n            parameter,\n            expectedTypes,\n            apiId,\n        })\n        : apiId => new httpErrors.InvalidApiIdError({\n            parameter,\n            apiId,\n        });\n\n    // Returning the list and the errors\n    return listId.reduce(({ value, errors }, apiId) => {\n        if (isValidApiId(apiId, expectedTypes)) {\n            value.push(apiId);\n        }\n        else {\n            errors.push(createError(apiId));\n        }\n\n        return { value, errors };\n    }, { value: [], errors: [] });\n}\n\n// ============================================================\n// Exports\nexport {\n    getListApiIdFromReq,\n    getListFromReq,\n    getOneDate,\n};\n"],"file":"request.js"}